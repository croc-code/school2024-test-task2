# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Один развивающийся и перспективный маркетплейс активно растет в настоящее время. Текущая команда разработки вовсю занята тем, что развивает ядро системы. Помимо этого, перед CTO маркетплейса стоит задача — разработать подсистему аналитики, которая на основе накопленных данных формировала бы разнообразные отчеты и статистику.

Вы — компания подрядчик, с которой маркетплейс заключил рамочный договор на выполнение работ по разработке этой подсистемы. В рамках первого этапа вы условились провести работы по прототипированию и определению целевого технологического стека и общих подходов к разработке.

На одном из совещаний с Заказчиком вы определили задачу, на которой будете выполнять работы по прототипированию. В качестве такой задачи была выбрана разработка отчета о наиболее популярных категориях товаров, продаваемых во время подготовки новогодних подарков покупателями.

Аналитики со стороны маркетплейса предоставили небольшой срез массива данных (файл format.json) о совершенных покупках пользователей за 4-й квартал 2023 года, на примере которого вы смогли бы ознакомиться с форматом входных данных. Каждая запись данного среза содержит следующую информацию:
- Дата и время оформления заказа;
- Корзина.

В пояснительной записке к массиву данных была уточняющая информация относительно формате данных, представленных в корзине. Так, например, корзина - это массив однотипных сведений о купленных товаров, определяемых следующим набором данных:
- Идентификатор товара;
- Наименование товара;
- Категория.

В свою очередь сведения о категории представлены в следующем виде:
- Идентификатор категории;
- Наименование категории.

Необходимо разработать отчет, определяющий категории товаров, наиболее популярные перед Новым годом. Если популярных категорий товаров больше, чем одна, отчет должен показывать их все. Предновогодним периодом будем считать срок с 1 по 31 декабря.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за формирование отчета, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует json-файл (input.json), соответствующий структуре, описанной в условиях задания;
3. Процедура (функция/метод) формирования отчета должна возвращать строку в формате json следующего формата:
   - {«categories»: [«Бытовая техника»]}
   - {«categories»: [«Бытовая техника», «Косметика»]}
4. Найденная в соответствии с условием задачи категория должна выводиться в изначальном наименовании, приведенном в файле с входными данными. Если таких категорий несколько, то на вывод они все подаются в алфавитном порядке.

## Автор решения
Ершов Кирилл Дмитриевич
## Описание реализации
Для решения будет использован следующие технологический стэк:
Java, Spring (Spring Boot, Spring Web)  
Spring Boot нам нужен, чтобы было удобнее запускать приложение.   
Spring Web же, чтобы прописать конечные точки.

Сервис для аналитики будет построен, как REST сервис.

Сервис будет спроектирован в соответствии со слоенной архитектурой, всего будет два слоя:
* Controller - отвечает за логику принятия и отправки сообщений.
* Service - нужен для реализации бизнес логики, в нашем же случае, там будет функция, отвечающая за выдачу отчета по самым популярным товарам за период с 1 по 31 декабря.

Также для удоства будут отпределены два DTO объекта, первый будет презентовать принимаемый набор данных, а второй выдачу отчета по набору данных.

Важно было бы отметить, что параметры для фильтрации могли бы быть заданы в параметрах запроса, но так как задача состояла сделать сервис по фильтрации специальных параметров, эту идею решено было не исполнять.
## Инструкция по сборке и запуску решения
С Docker:
1. Сначала скомпилируйте файл .jar. Для этого:  
   1.1. Войдите в корневую дирректорию проекта, то есть task2  
   1.2. Выполните команду "./mvnw install"
2. Далее запустите команду "docker compose up"

ИЛИ чтобы не мучаться с Docker:
1. Перейдите в корневую директорию проекта, то есть task2.
2. Выполните команду "./mvnw spring-boot:run"

Готово, теперь приложение будет доступно по http://localhost:8080.    
Конечно, чтобы протестировать приложение можно выполнить команду:

curl --location 'http://localhost:8080/purchases/analyze' \
--header 'Content-Type: application/json' \
--data '[
  {
    "ordered_at": "2023-12-14T11:10:29.408",
    "items": [
      {
        "id": "b250ed3c-25d7-462b-9aae-4cae6db4e1e5",
        "name": "Игровая приставка Sony Play Station 5",
        "category": {
          "id": "e3386407-3918-422a-b128-ad23a2ddf9c3",
          "name": "Бытовая техника"
        }
      },
      {
        "id": "bd4395cc-6602-4206-bc7a-01a8c5b1eef9",
        "name": "Набор уходовых средств Obagi",
        "category": {
          "id": "0bf9cb4d-30db-4440-a9dc-37edb0e78684",
          "name": "Средства для ухода за собой"
        }
      },
      {
        "id": "3975d9a4-1adc-4eab-baf1-55b59e78136d",
        "name": "Богатый папа, бедный папа",
        "category": {
          "id": "8b9bb003-6d90-43c4-9158-cfeca24b20f8",
          "name": "Книги"
        }
      }
    ]
  },
  {
    "ordered_at": "2023-12-21T18:31:21.349",
    "items": [
      {
        "id": "e188a4ce-d1c9-45b9-b757-4e9bcfc7281a",
        "name": "Телевизор LG C3",
        "category": {
          "id": "e3386407-3918-422a-b128-ad23a2ddf9c3",
          "name": "Бытовая техника"
        }
      },
      {
        "id": "a57548eb-9a1d-4d2c-8397-9d0c2c60fce6",
        "name": "Лонгслив SUPREME x CROC",
        "category": {
          "id": "593d36d5-1d8b-4237-beb4-e1c8e361c335",
          "name": "Одежда"
        }
      },
      {
        "id": "b8822fc1-b442-430c-9120-a3a1cedcb573",
        "name": "Набор зимней резины Pirelli",
        "category": {
          "id": "3d400f36-2766-40dc-95dd-f82cf3eef6f3",
          "name": "Автозапчасти"
        }
      }
    ]
  }
]'